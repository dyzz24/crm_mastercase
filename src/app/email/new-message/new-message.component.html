<div class="newMessage__container" (dragover)='dragStart($event)'>
  <div class="header">
    <div class="left__group">
      <div class="left__panel end">
      <app-template [ip]='this.emailServ.ip' [email_address]='this.emailServ.idPostForHTTP'></app-template>
      </div>
        <button type='button'>
            <span class='la la-ellipsis-h'></span>
          </button>
        </div>

      <button class='close' (click)='closeViewer()'>
          <span class='la la-close'></span>
        </button>
  </div>
  <div class="message__body">
<div class="avatar__block">
    <div class="avatar">
        <p class='avatar__title'>{{this?.from.charAt(0)}}</p>
      </div>
      <div class="avatar__row_block" (click)='select_new_address($event)'>
      <p class='head__p'>От: {{this?.from}}</p>
      <button class='select_btn'>
        <span class='la la-angle-down'></span>
      </button>
      <ul class="hidden_block" [ngClass]="{visibl: this.newMessageService.open_select_address}">
          <li *ngFor="let address of this.emailServ.all_user_mail_address" class='select_li'>{{address}}</li>
      </ul>
      </div>
</div>
<div class="row__block">
    <p class='head__p'>Кому: </p>
    <div class="new_message__bables" *ngFor="let item of this.newMessageService.to, let i = index" [ngClass]="{not__addressess: this.newMessageService.to[0] === '' || this.newMessageService.to[0] === undefined }">
      <p>{{item}}</p>
      <span class='la la-micro la-close' (click)='delete_data_clickEvent(this.newMessageService.to, $event, i)'></span>
    </div>
    <input class='input_fields' 
    (blur)="add_data(this.newMessageService.to, $event)" 
    (keydown)=' add_data_keyEvent(this.newMessageService.to, $event)'
    (keydown)='delete_data_keyEvent(this.newMessageService.to, $event)'
    >
</div>
<div class="row__block">
    <p class='head__p'>Копия: </p>
    <div class="new_message__bables" *ngFor="let item of this.newMessageService.copy,let i = index" [ngClass]="{not__addressess: this.newMessageService.copy.length === 0}">
        <p>{{item}}</p>
        <span class='la la-micro la-close' (click)='delete_data_clickEvent(this.newMessageService.copy, $event, i)'></span>
      </div>
    <input class='input_fields' 
    (blur)="add_data(this.newMessageService.copy, $event)" 
    (keydown)=' add_data_keyEvent(this.newMessageService.copy, $event)'
    (keydown)='delete_data_keyEvent(this.newMessageService.copy, $event)'
    >
</div>
<div class="row__block">
    <p class='head__p'>Скрытая: </p>
    <div class="new_message__bables" *ngFor="let item of this.newMessageService.hidden_copy,let i = index" [ngClass]="{not__addressess: this.newMessageService.hidden_copy.length === 0}">
        <p>{{item}}</p>
        <span class='la la-micro la-close' (click)='delete_data_clickEvent(this.newMessageService.hidden_copy, $event, i)'></span>
      </div>
    <input class='input_fields' 
    (blur)="add_data(this.newMessageService.hidden_copy, $event)" 
    (keydown)=' add_data_keyEvent(this.newMessageService.hidden_copy, $event)'
    (keydown)='delete_data_keyEvent(this.newMessageService.hidden_copy, $event)'
    >
</div>

<div class="row__block">
    <p class='head__p'>Тема: </p>

    <textarea class='input_fields subject' [(ngModel)]='this.newMessageService.subject' >{{this.newMessageService.subject}}</textarea>
</div>
<div class="row__block end_group" >
  <label>
      <span class='la la-paperclip visible'></span>
  <input type='file' class='file_btn' (change)='onFileChange($event)' multiple>
  <span class='button__title'>Прикрепить файл или перетащите файлы</span>
</label>


</div>


<div class="attachments" *ngIf="this.newMessageService.files_for_view.length !==0">
  <div class="attach_scrollBar">
    <div class="attach_group" *ngFor="let file of this.newMessageService.files_for_view; let i = index">
      <div class="name__block">
      <span [class]='file.name | attachPipe'></span>
      <p class='filename'>{{file.name}}</p>
      
      
    </div>
    <p class='size'>{{file.size | sizer}}</p>
      <span class='la la-micro la-close' (click)='delete_attach(i)'></span>
      </div>
    </div>
  </div>



    <div class="editor-qu">
      <quill-editor
      class='quill_styles'
      [(ngModel)]='this.newMessageService.messages'>
      
      
      </quill-editor>
      <div class="qu__bottom_block">
      <input type="submit" value='Отправить' (click)='sendMessage()'>
      <button class='save_templ' (click)='open_save_template()'>Сохранить как шаблон</button>
      <div class='templ_name' [ngClass]="{visibl: this.newMessageService.save_tmp_state}">
        <input type="text" placeholder="Имя шаблона"
        [(ngModel)]='this.newMessageService.tmp_name' 
        class='tmp_name_inp'
        >
        <button (click)='save_template()'>
            <span class='la la-check-circle-o'></span>
          </button>
      </div>
      </div> 
    </div>
    
    <div class="message__preload" *ngIf="this.messages_sending === true">
        <div class="cssload-speeding-wheel" ></div>
      <p>Отправка письма</p>
    </div>
  </div>
  <div class="drag_region"  (dragleave)='dragEnd($event)' (dragover)='dragStart($event)' (drop)='drop($event)'>
    <p>Брось файл тут</p>
  </div>
</div>
